lines â† â€¢FLines âŠ‘ â€¢args

ParseNumber â† {ğ•Šs:
  n â† âŠ‘0âŠËœ ('0' â‰¤ s) âˆ§ (s â‰¤ '9')
  !n>0
  x â† (10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½ ) -âŸœ'0' nâ†‘s
  âŸ¨x, nâ†“sâŸ©
}
ParseList â† {ğ•Šs:
  !'['â‰¡âŠ‘s
  xs â† âŸ¨âŸ©
  s â†© {ğ•Šs:
    {','â‰¡âŠ‘s ? 1â†“s;
     '['â‰¡âŠ‘s ? xâ€¿s â† ParseList   s â‹„ xs âˆ¾â†© <x â‹„ s;
              xâ€¿s â† ParseNumber s â‹„ xs âˆ¾â†© <x â‹„ s}
  } â€¢_while_ {ğ•Šs: (0<â‰ s) âˆ§ Â¬(']'â‰¡âŠ‘s)} 1â†“s
  !0<â‰ s â‹„ !']'â‰¡âŠ‘s
  âŸ¨xs, 1â†“sâŸ©
}
ParseThing â† {ğ•Šs:
  !Â¬']'â‰¡âŠ‘s â‹„ !Â¬','â‰¡âŠ‘s
  { '['â‰¡âŠ‘s ? ParseList s ; ParseNumber s }
}
ParseLine â† âŠ‘âˆ˜ParseThing

pairs â† <Ë˜ ParseLineÂ¨ Â¯1 â†“Ë˜ âˆ˜â€¿3 â¥Š lines âˆ¾ <""

Cmp â† {ağ•Šb:
  {0â€¿0: n â† a âŒŠâ—‹â‰  b â‹„ c â† a CmpÂ¨â—‹(nâŠ¸â†‘) b
            x â† Ã— Â¯1 -â—‹(âŠ‘âˆ˜(câŠ¸âŠ)) 1  # sign(indexof(-1) - indexof(1)) --- -1 if -1 comes before 1, vice versa, 0 if neither occurred
            {xâ‰¡0 ? Ã— a-â—‹â‰ b; x};  # if element comparison wasn't conclusive, compare lengths
   0â€¿1: a Cmp âŸ¨bâŸ©;
   1â€¿0: âŸ¨aâŸ© Cmp b;
   1â€¿1: Ã— a - b
  } â€¢TypeÂ¨ aâ€¿b
}

# part one
â€¢Show +Â´ 1+ / 0â‰¥ CmpÂ´Â¨ pairs

Merge â† {ağ•Šb:
  TakeA â† {ğ•Šğ•©: xâ†âŠ‘a â‹„ aâ†“Ëœâ†©1 â‹„ x}
  TakeB â† {ğ•Šğ•©: xâ†âŠ‘b â‹„ bâ†“Ëœâ†©1 â‹„ x}
  {ğ•©
    0â‰¡â‰ a ? TakeB @;
    0â‰¡â‰ b ? TakeA @;
    {(a Cmpâ—‹âŠ‘ b) < 0 ? TakeA @; TakeB @}
  }Â¨ â†•a+â—‹â‰ b
}
MergeSort â† {
  1â‰¥â‰ ğ•© ? ğ•©;
  k â† âŒŠ(â‰ ğ•©)Ã·2
  MergeÂ´ MergeSortÂ¨ âŸ¨kâ†‘ğ•©, kâ†“ğ•©âŸ©
}

# part two
dividers â† âŸ¨âŸ¨âŸ¨2âŸ©âŸ©, âŸ¨âŸ¨6âŸ©âŸ©âŸ©
â€¢Show Ã—Â´ â¥Š1+/Ë˜ dividers â‰¡âŒœ MergeSort dividers âˆ¾ â¥Š >pairs

