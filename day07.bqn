lines â† â€¢FLines âŠ‘â€¢args

StartsWith â† (â‰¤â—‹â‰ â—¶0â€¿(âŠ£â‰¡â‰ âŠ¸â†‘))Ëœ
Split â† (âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢
ParseInt â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½-âŸœ'0'

# collect list of files with absolute paths, and sizes
path â† âŸ¨âŸ©
nodes â† âŸ¨âŸ¨âŸ©âŸ©
sizes â† âŸ¨0âŸ©
ProcessCD â† {
  ğ•© â‰¡ "/"
    ? path â†© âŸ¨âŸ©
    ; ğ•© â‰¡ ".."
        ? path â†© Â¯1â†“path
        ; path â†© path âˆ¾ âŸ¨ğ•©âŸ©
}
ProcessFile â† {
  tagâ€¿name â† ' ' Split ğ•©
  size â† {tag â‰¡ "dir" ? 0 ; ParseInt tag}
  nodes â†© nodes âˆ¾ âŸ¨pathâˆ¾âŸ¨nameâŸ©âŸ©
  sizes â†© sizes âˆ¾ âŸ¨sizeâŸ©
}

{
ğ•© â‰¡ "$ ls" ? @ ;
ğ•© StartsWith "$ cd " ? ProcessCD 5â†“ğ•©;
Â¬ğ•© StartsWith "$" ? ProcessFile ğ•©
}Â¨ lines

# for each node, compute sum of descendant sizes (quadratic time)
n â† â‰ nodes
total_sizes â† {ğ•Ši:
  +Â´ {ğ•Šj:
    ((jâŠ‘nodes) StartsWith (iâŠ‘nodes))
    ? jâŠ‘sizes; 0
  }Â¨ â†•n
}Â¨ â†•n

# part one
â€¢Show total_sizes +Â´âˆ˜Ã— ((sizes = 0) âˆ§ (total_sizes â‰¤ 100000))

# part two
space_total â† 70000000
space_needed â† 30000000
space_free â† space_total - âŠ‘total_sizes
space_to_free â† space_needed - space_free
# find smallest directory of at least that size
candidates â† (sizes = 0) âˆ§ (total_sizes â‰¥ space_to_free)
â€¢Show âŒŠÂ´ candidates / total_sizes

