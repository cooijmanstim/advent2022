_dâ†{eâ†0â‹„ râ†ğ•¨ğ”½âŠ{eâ†©1â‹„â€¢CurrentErrorğ•©}ğ•©â‹„ â€¢Show["calling"â€¿((<ğ•¨)âŠ¢âŠ˜âˆ¾ğ•—â€¿ğ•©),(eâŠ‘"returned"â€¿"errored")â€¿r]â‹„ r!Â¬eâ‹„r}
ParseNat â† 10âŠ¸Ã—âŠ¸+ËœÂ´ âˆ˜âŒ½ -âŸœ'0'
ParseNum â† {ğ•Šğ•©: '-'â‰¡âŠ‘ğ•© ? -ParseNat 1â†“ğ•©; ParseNat ğ•©}
Enumerate â† {ğ•©â‹ˆËœÂ¨â†•â‰ ğ•©}
xs â† ParseNumÂ¨ â€¢FLinesâŠ‘â€¢args
n â† â‰ xs

Mix â† {kğ•Šxs:  # correct up to rotation
  p â† â†•n
  {ğ•©
    {ğ•Šiâ€¿x:
      src â† âŠ‘pâŠi â‹„ dst â† n|src+x
      x {0: 0; ((n-1)Ã—Ã—ğ•©)|ğ•©}â†©  # don't generate duplicate indices by cycling around multiple times
      p 1âŠ¸âŒ½ âŒ¾ ((n|src+(Ã—x)Ã—â†•1+|x)âŠ¸âŠ)â†©  # rotate cyclic slice [src,src+x]
    }Â¨ Enumerate xs
  }Â¨ â†•k
  p
}

{ # part one
  ys â† xsâŠËœ 1 Mix xs
  â€¢Show +Â´ ys âŠËœ nâŠ¸|Â¨ 1000â€¿2000â€¿3000 + ysâŠ0
}
{ # part two
  key â† 811589153
  ys â† key Ã— xs âŠËœ 10 Mix xs Ã—â—‹((n-1)âŠ¸|) key
  â€¢Show +Â´ ys âŠËœ nâŠ¸|Â¨ 1000â€¿2000â€¿3000 + ysâŠ0
}

